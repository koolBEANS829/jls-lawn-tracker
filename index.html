<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="description" content="JLS Lawn Maintenance Command Center - Schedule and manage lawn care jobs.">
    <title>JLS Lawn Maintenance Command Center</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

    <!-- FullCalendar -->
    <script src="fullcalendar.min.js"></script>

    <!-- Styles -->
    <link rel="stylesheet" href="style.css" type="text/css">
</head>

<body>
    <header class="app-header">
        <h1>JLS Maintenance Job Tracker</h1>
    </header>

    <main>
        <div class="app-card-wrapper">
            <div id="calendar"></div>

            <!-- Weekly Sum Tracker -->
            <div id="weekly-stats" class="weekly-stats hidden">
                <div class="stat-item">
                    <span class="stat-label">Potential</span>
                    <span class="stat-value" id="stat-potential">$0.00</span>
                </div>
                <div class="stat-divider">/</div>
                <div class="stat-item">
                    <span class="stat-label">Earned</span>
                    <span class="stat-value highlight" id="stat-earned">$0.00</span>
                </div>
            </div>
        </div>

        <button id="fab-add-job" class="fab-btn" aria-label="Add New Job">+</button>

        <!-- New Job Wizard -->
        <div id="wizard-overlay" class="wizard-overlay hidden">
            <div class="wizard-card">
                <div class="wizard-header">
                    <h2 id="wizard-title">New Job</h2>
                    <span id="wizard-close" class="close-btn">&times;</span>
                </div>
                <div class="wizard-form-stack">
                    <div class="form-group-large">
                        <label for="wizard-client">Who is the Client?</label>
                        <input type="text" id="wizard-client" placeholder="e.g. Smith Residence">
                    </div>
                    <div class="form-group-large">
                        <label for="wizard-phone">Phone Number (Optional)</label>
                        <input type="tel" id="wizard-phone" placeholder="e.g. 555-123-4567" inputmode="tel">
                    </div>
                    <div class="form-group-large">
                        <label for="wizard-address">Address</label>
                        <div class="autocomplete-wrapper">
                            <input type="text" id="wizard-address" placeholder="e.g. 123 Main St" autocomplete="off">
                            <div id="address-autocomplete" class="autocomplete-dropdown hidden"></div>
                        </div>
                    </div>
                    <div class="form-group-large">
                        <label>What's the Job?</label>
                        <div class="job-type-selection">
                            <button type="button" class="btn-big-type mowing" onclick="selectJobType('mowing')">üå±
                                MOWING</button>
                            <button type="button" class="btn-big-type hedge" onclick="selectJobType('hedge')">‚úÇÔ∏è
                                HEDGE</button>
                        </div>
                    </div>
                    <div class="form-group-large">
                        <label for="wizard-price">Price ($)</label>
                        <input type="number" id="wizard-price" placeholder="e.g. 50" inputmode="decimal">
                    </div>
                    <div class="form-group-large">
                        <label for="wizard-date">When?</label>
                        <input type="datetime-local" id="wizard-date">
                    </div>
                    <div class="form-group-large">
                        <label for="wizard-notes">Notes (Optional)</label>
                        <textarea id="wizard-notes" placeholder="e.g. Gate code is 1234"></textarea>
                    </div>
                    <div id="recurring-checkbox-container" class="form-group-large">
                        <label class="checkbox-label">
                            <input type="checkbox" id="wizard-recurring" onchange="toggleRecurringOptions()">
                            <span>üîÅ Make this a recurring job</span>
                        </label>
                    </div>
                    <div id="recurring-options" class="recurring-options hidden">
                        <div class="form-group-large">
                            <label for="wizard-frequency">How Often?</label>
                            <select id="wizard-frequency">
                                <option value="weekly">Weekly (Every 7 days)</option>
                                <option value="biweekly">Bi-weekly (Every 14 days)</option>
                                <option value="monthly">Monthly (Every 30 days)</option>
                            </select>
                        </div>
                        <div class="form-group-large">
                            <label for="wizard-occurrences">Number of Jobs</label>
                            <input type="number" id="wizard-occurrences" min="2" max="52" value="8">
                            <small class="field-hint">Creates this many jobs in advance</small>
                        </div>
                    </div>
                    <div class="wizard-actions right-align">
                        <button type="button" class="btn-save" onclick="saveJob()">SCHEDULE JOB</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Edit Scope Selection Modal -->
        <div id="edit-scope-modal" class="wizard-overlay hidden">
            <div class="wizard-card scope-card">
                <div class="wizard-header">
                    <h2>üîÅ Recurring Job</h2>
                </div>
                <div class="scope-content">
                    <p class="scope-prompt">This job is part of a recurring series. What would you like to edit?</p>
                    <div class="scope-options">
                        <button type="button" class="btn-scope-option single" onclick="selectEditScope('single')">
                            <span class="scope-icon">üìå</span>
                            <span class="scope-label">Just This Job</span>
                            <span class="scope-desc">Only modify this single occurrence</span>
                        </button>
                        <button type="button" class="btn-scope-option all" onclick="selectEditScope('all')">
                            <span class="scope-icon">üìã</span>
                            <span class="scope-label">All Jobs in Series</span>
                            <span class="scope-desc">Apply changes to every job in this series</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Cancel Scope Selection Modal -->
        <div id="cancel-scope-modal" class="wizard-overlay hidden">
            <div class="wizard-card scope-card cancel-scope-card">
                <div class="wizard-header cancel-header">
                    <h2>‚ö†Ô∏è Cancel Job</h2>
                </div>
                <div class="scope-content">
                    <p id="cancel-scope-prompt" class="scope-prompt">Are you sure you want to cancel this job?</p>
                    <div class="scope-options">
                        <!-- For non-recurring jobs, only this button shows -->
                        <button type="button" class="btn-scope-option cancel-single" id="btn-cancel-single"
                            onclick="confirmCancelScope('single')">
                            <span class="scope-icon">üö´</span>
                            <span class="scope-label">Cancel This Job</span>
                            <span class="scope-desc">Mark this job as cancelled</span>
                        </button>
                        <!-- These only show for recurring jobs -->
                        <button type="button" class="btn-scope-option cancel-future" id="btn-cancel-future"
                            onclick="confirmCancelScope('future')">
                            <span class="scope-icon">üìÖ</span>
                            <span class="scope-label">This & Future Jobs</span>
                            <span class="scope-desc">Cancel this and all upcoming jobs in series</span>
                        </button>
                        <button type="button" class="btn-scope-option cancel-all" id="btn-cancel-all"
                            onclick="confirmCancelScope('all')">
                            <span class="scope-icon">üóëÔ∏è</span>
                            <span class="scope-label">Entire Series</span>
                            <span class="scope-desc">Cancel all jobs in this series</span>
                        </button>
                    </div>
                    <button type="button" class="btn-nevermind" onclick="closeCancelModal()">Never mind</button>
                </div>
            </div>
        </div>

        <!-- Job Details Modal -->
        <div id="job-details-modal" class="wizard-overlay hidden">
            <div class="wizard-card">
                <div class="wizard-header">
                    <span id="view-job-close" class="close-btn">&times;</span>
                    <h2 id="view-job-title">Job Details</h2>
                </div>
                <div class="job-details-content">
                    <div id="view-job-type-badge" class="job-type-badge">MOWING</div>
                    <div class="detail-row"><strong>When:</strong> <span id="view-job-date">...</span></div>
                    <div class="detail-row"><strong>Address:</strong> <span id="view-job-address">...</span></div>
                    <div class="detail-row"><strong>Price:</strong> <span id="view-job-price">...</span></div>
                    <div class="detail-row" id="view-job-phone-row"><strong>Phone:</strong> <span
                            id="view-job-phone">...</span></div>
                    <div class="sms-actions">
                        <a id="btn-sms-remind" href="#" class="btn-sms remind">üì≤ Remind</a>
                        <a id="btn-sms-thanks" href="#" class="btn-sms thanks">‚≠ê Thank You</a>
                    </div>
                    <div class="detail-row"><strong>Notes:</strong>
                        <p id="view-job-notes" class="notes-box">No notes.</p>
                    </div>
                </div>
                <div class="wizard-actions">
                    <button id="btn-cancel-job" type="button" class="btn-cancel" onclick="cancelJob()">CANCEL
                        JOB</button>
                    <button id="btn-edit-job" type="button" class="btn-edit" onclick="editJob()">EDIT</button>
                    <button id="btn-mark-done" type="button" class="btn-complete" onclick="markJobAsDone()">MARK AS
                        DONE</button>
                </div>
            </div>
        </div>
    </main>

    <script src="script.js"></script>
</body>

</html>